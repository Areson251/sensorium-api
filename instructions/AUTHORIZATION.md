# АВТОРИЗАЦИЯ

Данный раздел содержит сценарий пользоваеля для создания аккаунта в базе данных и авторизацию новых камер наблюдения.

## Регистрация пользовательского аккаунта

1. Первым делоам необходимо зарегистрировать пользователя. Для этого используйте следующий эндпоинт:

```
/api/v1/auth/users/    

METHOD = POST

Body:
  "email": "user@example.com"
  "username": "user123"
  "password": "user1234"
```

Поле password должно содержать не менее 8 символов.

2. Затем необходимо авторизоваться под созданным именем и паролем по следующему эндпоинту:

```
/api/v1/auth/token/login/

METHOD = POST

Body:
  "username": "user123",
  "password": "user1234"
```

Ответом с сервера будет сгенерированный токен авторизации, который нужно будет использовать под заголовком Authorization в каждом следующем эндпоинте. Пример полученного токена: 

```
  "auth_token": "43dca77502651ba5aefac333594234301ae5643e"
```

## Регистрация девайса 

3. Далее нужно сгенерировать код-пароль для регистрации девайса пользователем. Для этого необходимо отправить пост запрос с пустым телом, но в заголовке Authorization необходимо указать сгенерированный токен пользователя. Синтаксис указан ниже.

```
/api/v1/auth/generate-device-code/

METHOD = POST

Headers:
  "Authorization": "Token 43dca77502651ba5aefac333594234301ae5643e"
```

Ответом на данный запрос будет сгенерированный пароль из 10 символов. Пример:

```
  "code": "Tbuvrbw8n0"
```

4. Для регистрации девайса необходимо отправить полученный пароль в теле пост запроса по слдующему эндпоинту:

```
/api/v1/auth/generate-device-code/

METHOD = POST

Headers:
  "Authorization": "Token 43dca77502651ba5aefac333594234301ae5643e"

Body:
  "code": "Tbuvrbw8n0"
```

В качестве респонса будет получен токен авторизации для девайса. Пример:
```
"device_token": "b0da83a15d6ef98afca3f81c7c6dcb9b3471c256"
```

Далее для эндпоинтов, предназначенных для мобильного приложения, необходимо указывать в заголовке запроса Authorization полученный токен **девайса**.